{% extends "base.html" %}

{% block title %}Roles - Team Management - Allo{% endblock %}

{% block content %}
<div class="min-h-screen bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center space-x-8">
                    <a href="/dashboard" class="text-xl font-semibold text-gray-900">Allo</a>
                    <div class="flex space-x-4">
                        <a href="/team" class="text-gray-500 hover:text-gray-700">Team</a>
                        <a href="/team/users" class="text-gray-500 hover:text-gray-700">Users</a>
                        <a href="/team/roles" class="text-indigo-600 font-medium">Roles</a>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <a href="/team/roles/new" 
                       class="bg-indigo-600 text-white px-4 py-2 rounded-md text-sm hover:bg-indigo-700">
                        Create Role
                    </a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
        <div class="bg-white shadow rounded-lg">
            <div class="px-6 py-4 border-b border-gray-200">
                <h3 class="text-lg font-medium text-gray-900">Roles & Permissions</h3>
            </div>
            
            {% if roles.len() == 0 %}
            <div class="p-6 text-center">
                <div class="text-gray-400 text-6xl mb-4">üõ°Ô∏è</div>
                <h3 class="text-lg font-medium text-gray-900 mb-2">No roles found</h3>
                <p class="text-gray-500 mb-4">Create roles to manage user permissions.</p>
                <a href="/team/roles/new" 
                   class="bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700">
                    Create First Role
                </a>
            </div>
            {% else %}
            <div class="divide-y divide-gray-200">
                {% for role in roles %}
                <div class="p-6">
                    <div class="flex items-start justify-between">
                        <div class="flex-1">
                            <div class="flex items-center space-x-3">
                                <h4 class="text-lg font-medium text-gray-900">{{ role.name }}</h4>
                                {% if role.is_active %}
                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800">
                                    Active
                                </span>
                                {% else %}
                                <span class="inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-gray-100 text-gray-800">
                                    Inactive
                                </span>
                                {% endif %}
                            </div>
                            
                            {% if role.description != "" %}
                            <p class="mt-1 text-sm text-gray-600">{{ role.description }}</p>
                            {% endif %}
                            
                            <div class="mt-3">
                                <p class="text-sm text-gray-500 mb-2">Permissions ({{ role.permission_count }}):</p>
                                <div class="flex flex-wrap gap-1">
                                    {% for permission in role.permissions %}
                                    <span class="inline-flex px-2 py-1 text-xs font-medium rounded bg-blue-100 text-blue-800">
                                        {{ permission }}
                                    </span>
                                    {% endfor %}
                                </div>
                            </div>
                            
                            <div class="mt-2 text-xs text-gray-400">
                                Created {{ role.created_at.format("%B %d, %Y") }}
                                {% if role.updated_at != role.created_at %}
                                ‚Ä¢ Updated {{ role.updated_at.format("%B %d, %Y") }}
                                {% endif %}
                            </div>
                        </div>
                        
                        <div class="flex space-x-2 ml-4">
                            <a href="/team/roles/{{ role.id }}/edit" 
                               class="text-indigo-600 hover:text-indigo-900 text-sm font-medium">
                                Edit
                            </a>
                            {% if role.name != "Super Admin" %}
                            <a href="/team/roles/{{ role.id }}/delete" 
                               onclick="return confirm('Are you sure you want to delete this role? Users with this role will lose these permissions.')"
                               class="text-red-600 hover:text-red-900 text-sm font-medium">
                                Delete
                            </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}